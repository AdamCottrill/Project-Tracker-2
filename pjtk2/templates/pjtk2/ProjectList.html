{% extends "pjtk2/pjtk2_base.html" %}
{% load crispy_forms_tags %}
{% load pjtk2_tags %}
{% block extrahead  %}

<script src="{{ STATIC_URL }}js/jquery-1.9.1.js"></script>
<script src="{{ STATIC_URL }}js/jquery-1.10.2.min.js"></script>
<!-- bootstrap widget theme -->
<link rel="stylesheet" href="{{ STATIC_URL }}css/theme.bootstrap.css">
<!-- tablesorter plugin -->
<script src="{{ STATIC_URL }}js/jquery.tablesorter.js"></script>
<!-- tablesorter widget file - loaded after the plugin -->
<script src="{{ STATIC_URL }}js/jquery.tablesorter.widgets.js"></script>



{% endblock %}

{% block title  %} {{ block.super }}| Projects  {% endblock %}

{% load pagination_tags %}

{% block content  %}


<div class="container" >
  <h1>{% if approved %} Approved and Ongoing {% endif %} Projects {% if year %}{{
  year }}{% endif %}{% if tag %}tagged with '{{ tag }}'{% endif %}
  {% if prj_ldr %} associated with {{ prj_ldr.first_name }} {{ prj_ldr.last_name }}: {% endif %}</h1>

<p>N = {{ object_list|length }}</p>

{% autopaginate filter.qs 50 as object_list %}

  <a href="#" onclick="toggle_visibility('filter');">Filter List: </a>
  <div id="filter" style="display:none">
    <div style="border: 1px solid #CCCCCC; padding:10px; border-radius: 15px;">
       {% crispy filter.form %}
    </div>
    <hr />
  </div>

  {% if object_list %}

  <table cellspacing="0" class="tablesorter">
    <thead>
      <tr>
        <th>Year</th>
        <th>Project Code</th>
        <th>Project Name</th>
        <th>Project Lead</th>
        <th>Project Type</th>
        <th>Status</th>
      </tr>
    </thead>
    {% for project in object_list %}
    <tr>
      <td> {{ project.year }} </td>
      <td>
        <a href="{{ project.get_absolute_url }}"> {{ project.prj_cd }}</a>
      </td>
      <td>
        {{ project.prj_nm  }}
      </td>
          <td><a href="{% url 'user_project_list' project.prj_ldr.username %}">
              {{ project.prj_ldr.first_name}} {{ project.prj_ldr.last_name }}</a></td>
      <td> {{ project.project_type }} </td>
      <td style="color:{{ project.status|highlight_status  }}">
        {{ project.status  }}
      </td>
    </tr>
    {% endfor %}
  </table>

  {% paginate %}

  {% if manager %}
        <a href="{% url 'ApproveProjects'  %}">
        <button type="button" class="btn bnt-default">Update this list</button> </a>
  {% endif %}

  {% else %}
  <br />
  <h4>Sorry no projects available.</h4>
  {% endif %}

</div>


<script type="text/javascript">

 $(".tablesorter").tablesorter({
   theme: 'bootstrap',
   widthFixed: true,
   showProcessing: true,
   headerTemplate: '{content} {icon}',
   widgets: ['zebra', 'uitheme', 'scroller'],
   widgetOptions: {
     scroller_height: 300,
     scroller_barWidth: 17,
     scroller_jumpToHeader: true,
     scroller_idPrefix: 's_'
   }
 });

</script>


<script type="text/javascript">
<!--

function toggle_visibility(id) {
var e = document.getElementById(id);
if(e.style.display == 'block')
e.style.display = 'none';
else
e.style.display = 'block';
}

//-->
</script>



{% endblock %}
